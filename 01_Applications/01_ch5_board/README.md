# 5チャンネル風掲示板アプリ 機能要件仕様書

## 1. 概要

### 1.1 プロジェクト概要
5ch（旧2ちゃんねる）風の匿名掲示板Webアプリケーション

### 1.2 基本方針
- **会員登録不要**：誰でも匿名で閲覧・投稿が可能
- **シンプルな操作性**：直感的に使えるUI
- **レトロな雰囲気**：5ch風のデザインテイスト

---

## 2. 画面構成

| 画面名 | URL例 | 概要 |
|--------|-------|------|
| トップページ | `/` | 板（カテゴリ）一覧を表示 |
| 板ページ | `/board/:boardId` | スレッド一覧を表示 |
| スレッドページ | `/board/:boardId/thread/:threadId` | レス一覧を表示 |
| スレッド作成ページ | `/board/:boardId/create` | 新規スレッド作成フォーム |

---

## 3. 機能要件

### 3.1 板（カテゴリ）機能

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| BD-001 | 板一覧表示 | トップページに全ての板を一覧表示する |
| BD-002 | 板選択 | 板をクリックするとスレッド一覧ページに遷移する |

### 3.2 スレッド機能

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| TH-001 | スレッド一覧表示 | 板内のスレッドを一覧表示する |
| TH-002 | スレッド作成 | タイトルと本文（1レス目）を入力して新規スレッドを作成する |
| TH-003 | スレッド並び替え | 勢い順／新着順／レス数順で並び替えできる |
| TH-004 | スレッド検索 | キーワードでスレッドタイトルを検索できる |
| TH-005 | スレッドdat落ち | レス数が1000に達したスレッドは書き込み不可になる |

### 3.3 レス（投稿）機能

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| RS-001 | レス一覧表示 | スレッド内の全レスを番号順に表示する |
| RS-002 | レス投稿 | 名前（任意）と本文を入力してレスを投稿する |
| RS-003 | アンカー機能 | `>>数字` 形式で他レスへのリンクを生成する |
| RS-004 | 名前欄 | 空欄の場合は「名無しさん」と表示する |
| RS-005 | sage機能 | メール欄に「sage」を入力するとスレッドを上げない |
| RS-006 | ID表示 | 投稿者を識別するIDを表示（日替わりで変更） |
| RS-007 | 投稿日時表示 | レスの投稿日時を表示する |
| RS-008 | トリップ機能 | 名前欄に `#パスワード` を入力すると固有のトリップを表示 |

### 3.4 表示機能

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| DS-001 | レス番号ジャンプ | URLに `#数字` を付けると該当レスにスクロール |
| DS-002 | アンカーポップアップ | アンカーにマウスオーバーで参照先レスをポップアップ表示 |
| DS-003 | 画像サムネイル | 画像URLがあればサムネイルを表示（任意） |
| DS-004 | 勢い表示 | スレッドの勢い（1日あたりのレス数）を表示 |

---

## 4. 画面仕様

### 4.1 トップページ
```
┌─────────────────────────────────────┐
│  【サイト名】5ch風掲示板              │
├─────────────────────────────────────┤
│  ■ カテゴリ                          │
│  ├─ 雑談系                           │
│  │   ├─ なんでも雑談                 │
│  │   └─ 質問・相談                   │
│  ├─ 趣味系                           │
│  │   ├─ ゲーム                       │
│  │   └─ 音楽                         │
│  └─ ...                              │
└─────────────────────────────────────┘
```

### 4.2 スレッド一覧ページ
```
┌─────────────────────────────────────┐
│  【板名】なんでも雑談                 │
│  [スレッド作成] [並び替え▼] [検索]   │
├─────────────────────────────────────┤
│  1. スレッドタイトルA (123)  勢い:50 │
│  2. スレッドタイトルB (456)  勢い:30 │
│  3. スレッドタイトルC (789)  勢い:20 │
│  ...                                 │
└─────────────────────────────────────┘
```

### 4.3 スレッドページ（レス表示）
```
┌─────────────────────────────────────┐
│  【スレッドタイトル】                 │
├─────────────────────────────────────┤
│  1 名前：名無しさん 2024/01/01 12:00 │
│    ID:abcd1234                       │
│    本文本文本文...                   │
│  ─────────────────────────────────  │
│  2 名前：名無しさん 2024/01/01 12:05 │
│    ID:efgh5678                       │
│    >>1                               │
│    本文本文本文...                   │
│  ─────────────────────────────────  │
│  ...                                 │
├─────────────────────────────────────┤
│  【書き込み欄】                       │
│  名前: [        ] メール: [        ] │
│  本文: [                           ] │
│  [書き込む]                          │
└─────────────────────────────────────┘
```

---

## 5. データ構造

### 5.1 板（Board）
| フィールド | 型 | 説明 |
|------------|------|------|
| id | string | 板ID（例: "zatsudan"） |
| name | string | 板名（例: "雑談"） |
| category | string | カテゴリ名 |
| createdAt | datetime | 作成日時 |

### 5.2 スレッド（Thread）
| フィールド | 型 | 説明 |
|------------|------|------|
| id | number | スレッドID（板内で連番） |
| boardId | string | 所属板ID |
| title | string | スレッドタイトル（最大48文字） |
| createdAt | datetime | 作成日時 |
| updatedAt | datetime | 最終更新日時（最新レス日時） |
| resCount | number | レス数 |
| isActive | boolean | 書き込み可能かどうか |

### 5.3 レス（Response）
| フィールド | 型 | 説明 |
|------------|------|------|
| id | number | レス番号（スレッド内で連番、1始まり） |
| threadId | number | 所属スレッドID |
| name | string | 投稿者名（デフォルト: "名無しさん"） |
| trip | string | トリップ（ハッシュ値） |
| mail | string | メール欄（sage等） |
| body | string | 本文 |
| userId | string | ID（IPベースで日替わり生成） |
| ipHash | string | IPアドレスのハッシュ（非公開・管理用） |
| createdAt | datetime | 投稿日時 |

---

## 6. バリデーションルール

| 項目 | ルール |
|------|--------|
| スレッドタイトル | 1〜48文字、必須 |
| 名前 | 0〜32文字、任意 |
| メール欄 | 0〜64文字、任意 |
| 本文 | 1〜2000文字、必須 |
| 連続投稿制限 | 同一IPから10秒以内の連投禁止 |
| スレッド作成制限 | 同一IPから5分以内のスレ立て禁止 |

---

## 7. 非機能要件

### 7.1 パフォーマンス
- スレッド一覧の表示は1秒以内
- レス1000件のスレッドも2秒以内に表示

### 7.2 セキュリティ
- XSS対策（本文のHTMLエスケープ）
- CSRF対策
- IPアドレスは直接保存せずハッシュ化

### 7.3 対応ブラウザ
- Chrome / Firefox / Safari / Edge（最新版）
- スマートフォン対応（レスポンシブ）

---

## 8. 将来的な拡張案（スコープ外）

- 画像アップロード機能
- NGワードフィルター
- 荒らし対策（自動BAN）
- 管理者画面
- 過去ログ閲覧機能

---

## 更新履歴

| 日付 | 版 | 内容 |
|------|-----|------|
| 2026/01/01 | 1.0 | 初版作成 |
